<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>서울 주요 건물 정보 지도</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=0449cd70666bd5232b467275d85f0fd7&libraries=clusterer"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI','Malgun Gothic',sans-serif; }
    :root {
      --primary: #2563eb; --primary-dark: #1d4ed8; --secondary: #f97316;
      --light: #f8fafc; --dark: #0f172a; --gray: #64748b; --light-gray: #e2e8f0;
      --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    body { display: flex; min-height: 100vh; background-color: #f1f5f9; color: #334155; overflow: hidden; }

    /* 사이드바 */
    #sidebar { width: 380px; height: 100vh; display: flex; flex-direction: column; background: white; box-shadow:2px 0 10px rgba(0,0,0,0.1); z-index:10; transition: transform .3s ease; }
    .sidebar-header { padding:20px; background:var(--primary); color:white; position:relative; }
    .sidebar-header h1 { font-size:1.5rem; font-weight:600; display:flex; align-items:center; gap:10px; }
    .sidebar-header h1 i { color:var(--secondary); }
    .sidebar-header p { font-size:.9rem; margin-top:8px; opacity:.9; }
    .toggle-sidebar { position:absolute; top:20px; right:20px; background:rgba(255,255,255,0.2); border:none; border-radius:50%; width:36px; height:36px; color:white; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all .3s; }
    .toggle-sidebar:hover { background:rgba(255,255,255,0.3); }
    .search-section { padding:20px; border-bottom:1px solid var(--light-gray); }
    .search-box { position:relative; margin-bottom:15px; }
    .search-box input { width:100%; padding:12px 15px 12px 40px; border-radius:8px; border:1px solid var(--light-gray); font-size:.95rem; transition:all .3s; }
    .search-box input:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(37,99,235,0.2); }
    .search-box i { position:absolute; left:15px; top:50%; transform:translateY(-50%); color:var(--gray); }
    .filter-section { display:flex; gap:10px; flex-wrap:wrap; padding:0 20px 20px; }
    .filter-btn { padding:8px 14px; background:var(--light); border:1px solid var(--light-gray); border-radius:30px; font-size:.85rem; cursor:pointer; transition:all .2s; }
    .filter-btn.active, .filter-btn:hover { background:var(--primary); border-color:var(--primary); color:white; }
    #building-list { flex:1; overflow-y:auto; padding:0 20px 20px; }
    .list-header { display:flex; justify-content:space-between; align-items:center; padding:20px 0 10px; margin-bottom:10px; border-bottom:1px solid var(--light-gray); }
    .list-header h2 { font-size:1.3rem; font-weight:600; }
    .result-count { background:var(--light); color:var(--gray); padding:4px 10px; border-radius:30px; font-size:.85rem; }
    .building-item { padding:18px; margin-bottom:15px; border-radius:12px; background:white; box-shadow:var(--card-shadow); cursor:pointer; transition:all .3s; border:2px solid transparent; }
    .building-item:hover { transform:translateY(-3px); box-shadow:0 6px 16px rgba(0,0,0,0.1); }
    .building-item.selected { border-color:var(--primary); background:#eff6ff; }
    .building-header { display:flex; align-items:center; gap:10px; margin-bottom:10px; }
    .building-type { font-size:.8rem; padding:4px 10px; border-radius:30px; background:var(--light); }
    .building-type.historical { background:#fef3c7; color:#92400e; }
    .building-type.government { background:#dbeafe; color:#1e40af; }
    .building-type.religious { background:#ede9fe; color:#5b21b6; }
    .building-type.landmark { background:#dcfce7; color:#166534; }
    .building-name { font-size:1.1rem; font-weight:600; color:var(--dark); }
    .building-info { display:flex; align-items:center; gap:15px; font-size:.9rem; color:var(--gray); margin-top:12px; }
    .building-info span { display:flex; align-items:center; gap:5px; }
    .building-image { width:100%; height:180px; border-radius:8px; margin-top:12px; object-fit:cover; background:#f1f5f9; }

    /* 지도+상세패널 컨테이너 */
    .main-container { flex:1; display:flex; height:100vh; position:relative; }

    #map { flex:1; }

    /* 상세 정보 패널 */
    #detail-panel {
      width:400px; background:white; border-left:1px solid var(--light-gray);
      box-shadow:-2px 0 10px rgba(0,0,0,0.05);
      padding:25px; overflow-y:auto;
      display:none; position:relative; z-index:20; flex-shrink:0;
    }
    #detail-panel.show { display:block; }

    .detail-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
    .close-detail { background:var(--light); border:none; border-radius:50%; width:36px; height:36px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:all .3s; }
    .close-detail:hover { background:var(--light-gray); }
    .detail-content img { width:100%; height:250px; border-radius:12px; object-fit:cover; margin-bottom:20px; }
    .detail-info { display:grid; grid-template-columns:repeat(2,1fr); gap:15px; margin-bottom:25px; }
    .detail-info div { padding:15px; background:var(--light); border-radius:10px; }
    .detail-info h4 { font-size:.9rem; color:var(--gray); margin-bottom:8px; }
    .detail-info p { font-size:1.1rem; font-weight:500; }
    .detail-description { line-height:1.7; color:var(--dark); }

    @media(max-width:992px) {
      #sidebar { position:absolute; transform:translateX(-100%); }
      #sidebar.show { transform:translateX(0); }
      .toggle-sidebar { display:flex; }
      .detail-description, .detail-info { font-size:.9rem; }
    }
    @media(max-width:576px) {
      #sidebar { width:100%; }
      .sidebar-header h1 { font-size:1.3rem; }
    }
  </style>
</head>
<body>
  <div id="sidebar" class="show">
    <div class="sidebar-header">
      <h1><i class="fas fa-building"></i> 서울 주요 건물 정보</h1>
      <p>서울의 주요 건물 정보를 지도에서 확인하세요</p>
      <button class="toggle-sidebar" id="toggleSidebar"><i class="fas fa-times"></i></button>
    </div>
    <div class="search-section">
      <div class="search-box"><i class="fas fa-search"></i><input type="text" id="searchInput" placeholder="건물명 검색..."></div>
      <div class="filter-section">
        <button class="filter-btn active" data-filter="all">전체</button>
        <button class="filter-btn" data-filter="government">정부기관</button>
        <button class="filter-btn" data-filter="historical">역사적 건물</button>
        <button class="filter-btn" data-filter="religious">종교 건물</button>
        <button class="filter-btn" data-filter="landmark">랜드마크</button>
      </div>
    </div>
    <div id="building-list">
      <div class="list-header"><h2>건물 목록</h2><div class="result-count" id="resultCount">5개 건물</div></div>
      <div id="building-items"></div>
    </div>
  </div>

  <div class="main-container">
    <div id="detail-panel">
      <div class="detail-header"><h2 id="detail-title">건물 상세 정보</h2><button class="close-detail" id="closeDetail"><i class="fas fa-times"></i></button></div>
      <div class="detail-content" id="detailContent"></div>
    </div>
    <div id="map"></div>
  </div>

  <script>
    const buildingData = [
      { id:1, name:'서울특별시청', type:'government', lat:37.5662952, lng:126.9779451, image:'https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Seoul_City_Hall.jpg/800px-Seoul_City_Hall.jpg', description:'서울특별시의 행정 중심지로, 서울광장과 접해 있으며 다양한 문화 행사가 열리는 장소입니다. 지하철 1호선 시청역과 바로 연결되어 접근성이 좋습니다.', year:'1926년 완공', address:'서울 중구 세종대로 110', hours:'09:00 - 18:00 (평일)', contact:'02-120' },
      { id:2, name:'덕수궁', type:'historical', lat:37.565804, lng:126.975146, image:'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/Deoksugung.jpg/800px-Deoksugung.jpg', description:'조선시대의 궁궐 중 하나로, 대한제국 시기 황궁으로 사용되었습니다. 고종 황제가 거주했던 곳으로, 서양식 건물인 석조전이 유명합니다.', year:'15세기 초기 건립', address:'서울 중구 세종대로 99', hours:'09:00 - 21:00 (화-일)', contact:'02-771-9951' },
      { id:3, name:'정동제일교회', type:'religious', lat:37.566527, lng:126.973832, image:'https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Jeongdong_Church.jpg/800px-Jeongdong_Church.jpg', description:'대한민국 최초의 개신교 교회로, 근대문화유산으로 지정되어 있습니다. 고종 황제가 기공식을 거행하고 기념식수한 역사적 의미가 있는 건물입니다.', year:'1897년 완공', address:'서울 중구 정동길 46', hours:'09:00 - 18:00 (매일)', contact:'02-753-1783' },
      { id:4, name:'서울역', type:'historical', lat:37.554648, lng:126.972559, image:'https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Seoul_Station_2011.jpg/800px-Seoul_Station_2011.jpg', description:'1925년에 완공된 역사적인 기차역으로, 서울의 주요 교통 허브입니다. 구 서울역 건물은 현재 문화역서울 284로 활용되고 있습니다.', year:'1925년 완공', address:'서울 용산구 한강대로 405', hours:'24시간 운영', contact:'1544-7788' },
      { id:5, name:'남산서울타워', type:'landmark', lat:37.551169, lng:126.988226, image:'https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/Seoul_N_Tower_1.jpg/800px-Seoul_N_Tower_1.jpg', description:'서울의 대표적인 랜드마크로, 남산 정상에 위치한 전망타워입니다. 서울 시내의 파노라마 뷰를 감상할 수 있으며, 연인들의 데이트 명소로 유명합니다.', year:'1975년 완공', address:'서울 용산구 남산공원길 105', hours:'10:00 - 23:00 (매일)', contact:'02-3455-9277' }
    ];
    const mapContainer = document.getElementById('map');
    const mapOption = { center: new kakao.maps.LatLng(37.5665, 126.9780), level:6 };
    const map = new kakao.maps.Map(mapContainer, mapOption);
    const clusterer = new kakao.maps.MarkerClusterer({ map, averageCenter:true, minLevel:5 });
    const markerImages = {
      government:new kakao.maps.MarkerImage('https://i.imgur.com/4S3eO1d.png',new kakao.maps.Size(40,40)),
      historical:new kakao.maps.MarkerImage('https://i.imgur.com/jJv9SJ1.png',new kakao.maps.Size(40,40)),
      religious:new kakao.maps.MarkerImage('https://i.imgur.com/8r5mhUQ.png',new kakao.maps.Size(40,40)),
      landmark:new kakao.maps.MarkerImage('https://i.imgur.com/0q7Vk8v.png',new kakao.maps.Size(40,40))
    };
    const selectedMarkerImage = new kakao.maps.MarkerImage('https://i.imgur.com/3d9cFgV.png',new kakao.maps.Size(50,50));
    const markers = [], buildingItems = document.getElementById('building-items'), resultCount = document.getElementById('resultCount');
    const filterButtons = document.querySelectorAll('.filter-btn'), searchInput = document.getElementById('searchInput');
    let selectedMarker=null, selectedBuilding=null;
    const detailPanel = document.getElementById('detail-panel'),
          detailTitle = document.getElementById('detail-title'),
          detailContent = document.getElementById('detailContent'),
          closeDetailBtn = document.getElementById('closeDetail');

    function getBuildingTypeName(type) {
      return { government:'정부기관', historical:'역사적 건물', religious:'종교 건물', landmark:'랜드마크' }[type] || type;
    }

    function renderBuildingList(buildings) {
      buildingItems.innerHTML = '';
      resultCount.textContent = `${buildings.length}개 건물`;
      buildings.forEach(b => {
        const item=document.createElement('div'); item.className='building-item'; item.dataset.id=b.id;
        item.innerHTML=`
          <div class="building-header">
            <div class="building-type ${b.type}">${getBuildingTypeName(b.type)}</div>
            <div class="building-name">${b.name}</div>
          </div>
          <p class="building-description">${b.description.substring(0,70)}...</p>
          <div class="building-info">
            <span><i class="fas fa-map-marker-alt"></i> ${b.address}</span>
            <span><i class="fas fa-clock"></i> ${b.hours}</span>
          </div>
          <img src="${b.image}" alt="${b.name}" class="building-image">
        `;
item.addEventListener('click', ()=> {
  const mo = markers.find(m => m.building.id === b.id);
  if(mo) {
    kakao.maps.event.trigger(mo.marker, 'click');
    // 사이드바에서 클릭했을 때만 지도 중심 이동
    map.setCenter(new kakao.maps.LatLng(b.lat, b.lng));
  }
});
        buildingItems.appendChild(item);
      });
    }

    function selectBuildingInList(id) {
      document.querySelectorAll('.building-item').forEach(el => {
        el.classList.remove('selected');
        if(parseInt(el.dataset.id)===id) el.classList.add('selected'), el.scrollIntoView({behavior:'smooth',block:'nearest'});
      });
    }

    function showBuildingDetail(b) {
      detailTitle.textContent=b.name;
      detailContent.innerHTML=`
        <img src="${b.image}" alt="${b.name}">
        <div class="detail-info">
          <div><h4>건축 연도</h4><p>${b.year}</p></div>
          <div><h4>운영 시간</h4><p>${b.hours}</p></div>
          <div><h4>연락처</h4><p>${b.contact}</p></div>
          <div><h4>주소</h4><p>${b.address}</p></div>
        </div>
        <div class="detail-description"><h3>상세 정보</h3><p>${b.description}</p></div>`;
      detailPanel.classList.add('show');
    }

 // 마커 & 인포윈도우 등록
buildingData.forEach(b => {
  const pos = new kakao.maps.LatLng(b.lat, b.lng);
  const marker = new kakao.maps.Marker({
    position: pos,
    image: markerImages[b.type]
  });
  markers.push({ marker, building: b });

  // ✅ 인포윈도우 생성 (여기서 b.name 사용)
  const infoWindow = new kakao.maps.InfoWindow({
    content: `<div style="padding:5px;font-size:14px;font-weight:bold;">${b.name}</div>`,
    removable: false
  });

  // ✅ 마커 마우스오버/아웃 이벤트 등록
  kakao.maps.event.addListener(marker, 'mouseover', function () {
    infoWindow.open(map, marker);
  });

  kakao.maps.event.addListener(marker, 'mouseout', function () {
    infoWindow.close();
  });

  // 마커 클릭 이벤트
  kakao.maps.event.addListener(marker, 'click', () => {
    if (selectedMarker) {
      selectedMarker.setImage(markerImages[selectedBuilding.type]);
    }
    marker.setImage(selectedMarkerImage);
    selectedMarker = marker;
    selectedBuilding = b;
    showBuildingDetail(b);
    selectBuildingInList(b.id);
  });
});

    clusterer.addMarkers(markers.map(m=>m.marker));

    searchInput.addEventListener('input', filterBuildings);
    filterButtons.forEach(btn=>btn.addEventListener('click',function(){
      filterButtons.forEach(b=>b.classList.remove('active'));
      this.classList.add('active'); filterBuildings();
    }));
    closeDetailBtn.addEventListener('click',()=>{
      detailPanel.classList.remove('show');
      if(selectedMarker && selectedBuilding) {
        selectedMarker.setImage(markerImages[selectedBuilding.type]);
        selectedMarker=null; selectedBuilding=null;
      }
      document.querySelectorAll('.building-item').forEach(el=>el.classList.remove('selected'));
    });

    function filterBuildings() {
      const t= document.querySelector('.filter-btn.active').dataset.filter;
      const term = searchInput.value.toLowerCase();
      renderBuildingList(buildingData.filter(b=>
        (t==='all'||b.type===t)&&
        (b.name.toLowerCase().includes(term)||b.description.toLowerCase().includes(term))
      ));
    }

    renderBuildingList(buildingData);
  </script>
</body>
</html>
