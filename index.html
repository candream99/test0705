<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë°ìŠ¤í¬íƒ‘ ì „ìš© ì§€ë„</title>
    <style>
        /* ì „ì²´ ë° ë ˆì´ì•„ì›ƒ */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Malgun Gothic', sans-serif;
            overflow: hidden;
        }
        #container {
            display: flex;
            width: 100vw;
            height: 100vh;
        }

        /* ì™¼ìª½ ì‚¬ì´ë“œë°”: í™”ë©´ì˜ 1/5 (20%) */
        #sidebar {
            width: 20%;
            min-width: 260px;
            max-width: 420px;
            height: 100%;
            box-sizing: border-box;
            background: #fafafa;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
        }

        /* ê²€ìƒ‰ì˜ì—­ */
        #searchArea {
            padding: 14px;
            border-bottom: 1px solid #eee;
            background: #fff;
        }
        #searchInput {
            width: 100%;
            height: 42px;
            padding: 0 12px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-size: 15px;
            box-sizing: border-box;
        }

        #buildingList {
            padding: 10px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            flex: 1 1 auto;
        }

        .building-card {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            padding: 10px;
            border-radius: 8px;
            background: white;
            margin-bottom: 10px;
            cursor: pointer;
            border: 1px solid #f0f0f0;
            transition: box-shadow .12s, transform .08s;
        }
        .building-card:hover {
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
        .building-thumb {
            width: 72px;
            height: 72px;
            object-fit: cover;
            border-radius: 6px;
            flex-shrink: 0;
            background: #f3f4f6;
        }
        .building-info {
            flex: 1 1 auto;
        }
        .building-name {
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 6px;
            color: #111827;
        }
        .building-meta {
            font-size: 13px;
            color: #6b7280;
            line-height: 1.25;
        }

        /* ì‹¤ë‚´ëª¨ë“œ ì •ë³´ íŒ¨ë„ */
        #indoorInfoPanel {
            padding: 14px;
            display: none;
            overflow-y: auto;
        }
        #indoorInfoPanel img {
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 12px;
        }
        #indoorInfoPanel .title {
            font-size: 18px;
            font-weight: 800;
            margin-bottom: 8px;
            color: #111827;
        }
        #indoorInfoPanel .meta {
            font-size: 14px;
            color: #444;
            margin-bottom: 4px;
        }
        #indoorInfoPanel .section-title {
            margin-top: 18px;
            font-weight: 700;
            font-size: 15px;
            color: #1f2e6a;
            margin-bottom: 8px;
        }
        #indoorInfoPanel .facility-item {
            font-size: 14px;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
        }

        /* ì˜¤ë¥¸ìª½: ì§€ë„ 4/5 (80%) */
        #mapContainer {
            width: 80%;
            height: 100%;
            position: relative;
        }
        #map {
            width: 100%;
            height: 100%;
        }

        /* coordDisplay */
        #coordDisplay {
            position: absolute;
            top: 14px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2500;
            background: rgba(255,255,255,0.95);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
            font-size: 14px;
            color: #111827;
            white-space: nowrap;
            max-width: 66%;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
        }

        /* ì§€ë„ ìœ„ ë²„íŠ¼ */
        .map-btn-circle {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #ffffff;
            border: none;
            box-shadow: 0 3px 10px rgba(0,0,0,0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2200;
        }
        #geolocationBtn {
            position: absolute;
            bottom: 18px;
            left: 18px;
        }

        #floorControls {
            position: absolute;
            bottom: 86px;
            left: 18px;
            display: none;
            flex-direction: column-reverse;
            gap: 10px;
            z-index: 2200;
        }

        /* ë°˜ì‘í˜• ìµœì†Œí™” */
        @media (max-width: 920px) {
            #sidebar { display: none; }
            #mapContainer { width: 100%; }
        }
    </style>
</head>

<body>
<div id="container">

    <!-- ì™¼ìª½ íŒ¨ë„ -->
    <aside id="sidebar">
        <!-- ì‹¤ì™¸ëª¨ë“œ: ê²€ìƒ‰ -->
        <div id="searchArea">
            <input id="searchInput" type="text" placeholder="ê²€ìƒ‰â€¦">
        </div>
        <div id="buildingList"></div>

        <!-- ì‹¤ë‚´ëª¨ë“œ ì „ìš© ì •ë³´ íŒ¨ë„ -->
        <div id="indoorInfoPanel"></div>
    </aside>

    <!-- ì§€ë„ ì˜ì—­ -->
    <section id="mapContainer">
        <div id="map"></div>

        <div id="coordDisplay">ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”</div>

        <!-- í˜„ì¬ ìœ„ì¹˜ ë²„íŠ¼ -->
        <button id="geolocationBtn" class="map-btn-circle"></button>

        <!-- ì¸µ ë²„íŠ¼ ì»¨íŠ¸ë¡¤ -->
        <div id="floorControls"></div>
    </section>

</div>


<script>
/* ë„¤ì´ë²„ì§€ë„ ë¡œë“œ */
var NCP_KEY_ID = "q1d23mmkof";
var script = document.createElement("script");
script.src = "https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId="+NCP_KEY_ID+"&vmode=3";

script.onload = function() {

    /* DOM */
    const searchArea = document.getElementById("searchArea");
    const buildingList = document.getElementById("buildingList");
    const searchInput = document.getElementById("searchInput");
    const indoorInfoPanel = document.getElementById("indoorInfoPanel");

    const floorControls = document.getElementById("floorControls");
    const coordDisplay = document.getElementById("coordDisplay");
    const geolocationBtn = document.getElementById("geolocationBtn");

    /* ì§€ë„ ìƒì„± */
    var map = new naver.maps.Map("map", {
        center: new naver.maps.LatLng(37.5710, 126.9784),
        zoom: 17,
        zoomControl: false,
        mapTypes: new naver.maps.MapTypeRegistry({
            normal: naver.maps.NaverStyleMapTypeOptions.getVectorMap(),
        }),
    });
    var labelLayer = new naver.maps.LabelLayer();
    labelLayer.setMap(map);

    var groundOverlay = null;
    var currentBuildingId = null;
    var currentPositionMarker = null;

    /* ì‹¤ë‚´ëª¨ë“œ ì‹œ ì™¼ìª½ íŒ¨ë„ì„ ì •ë³´ íŒ¨ë„ë¡œ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜ */
    function showIndoorInfo(buildingId) {
        const b = buildings[buildingId];

        indoorInfoPanel.innerHTML = `
            <img src="${b.buildingInfo.image_url}">
            <div class="title">${b.buildingInfo.name}</div>
            <div class="meta">ğŸ“ ${b.buildingInfo.address}</div>
            <div class="meta">ğŸ•’ ${b.buildingInfo.operating_hours}</div>

            <div class="section-title">ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´</div>
            ${Object.entries(b.accessInfo).map(([k,v]) => `
                <div class="facility-item"><span>â€¢ ${k}</span><span>${v?'ìˆìŒ':'ì—†ìŒ'}</span></div>
            `).join("")}
        `;
    }

    /* ì‹¤ë‚´ëª¨ë“œ ì§„ì… */
    function enterIndoorMode(buildingId){
        currentBuildingId = buildingId;

        // ê²€ìƒ‰ UI ìˆ¨ê¹€
        searchArea.style.display = "none";
        buildingList.style.display = "none";

        // ì‹¤ë‚´ ì •ë³´ íŒ¨ë„ í‘œì‹œ
        indoorInfoPanel.style.display = "block";
        showIndoorInfo(buildingId);

        // ì§€ë„ ì¤Œ/ì¤‘ì•™ ì¬ì¡°ì •
        const config = buildings[buildingId];
        const bounds = new naver.maps.LatLngBounds();
        config.polygonCoords.forEach(c=>bounds.extend(c));
        map.setCenter(bounds.getCenter());
        map.setZoom(18);

        labelLayer.setMap(null);
        coordDisplay.textContent = "ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ í´ë¦­í•˜ì„¸ìš”";

        // ì¸µ ë²„íŠ¼ í‘œì‹œ
        renderFloorButtons(buildingId);
        floorControls.style.display = "flex";

        showFloor(buildingId, config.currentFloor || "1f");

        // ë‹¤ë¥¸ ê±´ë¬¼ í´ë¦¬ê³¤ ìˆ¨ê¹€
        for (let id in buildings){
            if (id !== buildingId && buildings[id].polygon){
                buildings[id].polygon.setMap(null);
            }
        }
    }

    /* ì‹¤ë‚´ëª¨ë“œ ì¢…ë£Œ */
    function exitIndoorMode(){
        if (!currentBuildingId) return;

        if (groundOverlay) groundOverlay.setMap(null);
        labelLayer.setMap(map);
        currentBuildingId = null;

        // ê²€ìƒ‰ UI ë³µê·€
        searchArea.style.display = "block";
        buildingList.style.display = "block";

        // ì‹¤ë‚´ ì •ë³´ íŒ¨ë„ ìˆ¨ê¹€
        indoorInfoPanel.style.display = "none";

        // ì¸µ ë²„íŠ¼ ìˆ¨ê¹€
        floorControls.style.display = "none";

        coordDisplay.textContent = "ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”";

        // ëª¨ë“  í´ë¦¬ê³¤ ë³µêµ¬
        for (let id in buildings){
            if (buildings[id].polygon){
                buildings[id].polygon.setMap(map);
                buildings[id].polygon.setOptions({ fillColor:"transparent" });
            }
        }
    }

    function showFloor(buildingId, floor){
        const b = buildings[buildingId];

        if (groundOverlay) groundOverlay.setMap(null);

        const img = b.images[floor];
        const bound = b.floorBounds[floor];

        groundOverlay = new naver.maps.GroundOverlay(img, bound, {
            map: map,
            clickable: true,
            opacity: 1
        });

        b.currentFloor = floor;

        // ì¸µ ë²„íŠ¼ active í‘œì‹œ
        document.querySelectorAll("#floorControls .floor-btn").forEach(btn=>{
            btn.classList.remove("active");
        });
        const btn = document.querySelector(`#floorControls .floor-btn[data-floor="${floor}"]`);
        if (btn) btn.classList.add("active");

        // í´ë¦­í•˜ë©´ ì‹¤ì™¸ëª¨ë“œ ë³µê·€
        naver.maps.Event.addListener(groundOverlay,"click",(e)=>{
            e.stopOverlays = true;
            exitIndoorMode();
        });
    }

    function renderFloorButtons(buildingId){
        floorControls.innerHTML = "";
        const b = buildings[buildingId];
        b.floors.forEach(f=>{
            const btn = document.createElement("button");
            btn.className = "floor-btn map-btn-circle";
            btn.dataset.floor = f;
            btn.textContent = f.toUpperCase();
            btn.addEventListener("click", ()=> showFloor(buildingId,f));
            floorControls.prepend(btn);
        });
    }

    /* ì§€ì˜¤ë¡œì¼€ì´ì…˜ */
    geolocationBtn.addEventListener("click",function(){
        if (this.classList.contains("active")){
            if (currentPositionMarker) currentPositionMarker.setMap(null);
            this.classList.remove("active");
            coordDisplay.textContent = currentBuildingId
                ? "ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ í´ë¦­í•˜ì„¸ìš”"
                : "ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”";
            return;
        }
        if (navigator.geolocation){
            navigator.geolocation.getCurrentPosition(pos=>{
                const c = new naver.maps.LatLng(pos.coords.latitude,pos.coords.longitude);
                map.setCenter(c);
                map.setZoom(17);
                if (currentPositionMarker) currentPositionMarker.setMap(null);
                currentPositionMarker = new naver.maps.Marker({
                    map: map,
                    position: c
                });
                geolocationBtn.classList.add("active");
            });
        }
    });

    /* ë¹Œë”© ì •ì˜ */
    const buildings = {
        ky: {
            buildingInfo:{
                name:"êµë³´ë¹Œë”©",
                image_url:"https://raw.githubusercontent.com/candream99/disabledmap/main/kb/kyobo_gwanghwamun.jpg",
                address:"ì„œìš¸ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ 45",
                operating_hours:"09:00 - 18:00"
            },
            accessInfo:{
                "ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ":true,
                "ì¥ì• ì¸ í™”ì¥ì‹¤":true,
                "ì¥ì• ì¸ ì£¼ì°¨ì¥":true,
                "ì—˜ë¦¬ë² ì´í„°":true,
                "ì£¼ì¶œì…êµ¬ ë‹¨ì°¨":false
            },
            floors:["b1","1f","2f"],
            currentFloor:"1f",
            images:{
                "b1":"https://raw.githubusercontent.com/candream99/disabledmap/main/kb/kb_b111.png",
                "1f":"https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky11.png",
                "2f":"https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky_1.jpg"
            },
            floorBounds:{
                "b1":new naver.maps.LatLngBounds(
                    new naver.maps.LatLng(37.571590,126.978531),
                    new naver.maps.LatLng(37.570465,126.977552)),
                "1f":new naver.maps.LatLngBounds(
                    new naver.maps.LatLng(37.570512,126.977632),
                    new naver.maps.LatLng(37.571415,126.978244)),
                "2f":new naver.maps.LatLngBounds(
                    new naver.maps.LatLng(37.570512,126.977632),
                    new naver.maps.LatLng(37.571415,126.978244)),
            },
            polygonCoords:[
                new naver.maps.LatLng(37.571350, 126.977670),
                new naver.maps.LatLng(37.571360, 126.978059),
                new naver.maps.LatLng(37.571275, 126.978063),
                new naver.maps.LatLng(37.571275, 126.978173),
                new naver.maps.LatLng(37.570870, 126.978184),
                new naver.maps.LatLng(37.570872, 126.978082),
                new naver.maps.LatLng(37.570543, 126.978094),
                new naver.maps.LatLng(37.570539, 126.977702),
            ]
        },
        dt: { 
                    // ê±´ë¬¼ 2 (ì˜ˆì‹œ: ê´‘í™”ë¬¸ Díƒ€ì›Œ)
                    polygonCoords: [
                        new naver.maps.LatLng(37.571470, 126.978762),
                        new naver.maps.LatLng(37.571476, 126.979161),
                        new naver.maps.LatLng(37.570627, 126.979181),
                        new naver.maps.LatLng(37.570557, 126.979117),
                        new naver.maps.LatLng(37.570553, 126.978777),
                    ],
                    floors: ['b4', '1f'], 
                    images: {
                        'b4': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/dt_b4.png',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/dt1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë¶„ë¦¬í•˜ì—¬ ì €ì¥
                    floorBounds: { 
                "b4":new naver.maps.LatLngBounds(
                    new naver.maps.LatLng(37.570512,126.977632),
                    new naver.maps.LatLng(37.571415,126.978244)),
                "1f":new naver.maps.LatLngBounds(
                    new naver.maps.LatLng(37.570459,126.978649),
                    new naver.maps.LatLng(37.571626,126.979210)),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': false,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': true 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                    buildingInfo: {
                        name: 'ê´‘í™”ë¬¸ Díƒ€ì›Œ',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/d_tower.jpg', 
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ì†¡ì›”ê¸¸ 2',
                        operating_hours: '10:00 - 19:00 (ë§¤ì¼ ìš´ì˜)'
                    }
                },
         't8': { // ê±´ë¬¼ 3: íƒ€ì›Œ8
                    polygonCoords: [
                        new naver.maps.LatLng(37.570859, 126.980318),
                        new naver.maps.LatLng(37.570854, 126.980784),
                        new naver.maps.LatLng(37.570515, 126.980785),
                        new naver.maps.LatLng(37.570514, 126.980841),
                        new naver.maps.LatLng(37.570417, 126.980840),
                        new naver.maps.LatLng(37.570418, 126.980288),
                        new naver.maps.LatLng(37.570518, 126.980287),
                        new naver.maps.LatLng(37.570518, 126.980315),
                    ],
                    floors: ['b2', 'b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µë³„ ë²„íŠ¼ ìˆœì„œ
                    images: {
                        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/T8_b2.png',
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/T8_b1.png',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/T8_1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë¶„ë¦¬í•˜ì—¬ ì €ì¥
                    floorBounds: { 
                        // ìš”ì²­í•˜ì‹  ë™ì¼í•œ ë¶ë™(NE) ë° ë‚¨ì„œ(SW) ì¢Œí‘œë¥¼ ëª¨ë“  ì¸µì— ì ìš©
                        'b2': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570405, 126.980209), // SW
                            new naver.maps.LatLng(37.570902, 126.981077)  // NE
                        ),
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570405, 126.980209), // SW
                            new naver.maps.LatLng(37.570902, 126.981077)  // NE
                        ),
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570405, 126.980209), // SW
                            new naver.maps.LatLng(37.570902, 126.981077)  // NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': false, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                    buildingInfo: {
                        name: 'íƒ€ì›Œ8',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/t88.jpg', 
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ì²­ì§„ë™ 167 (ì„ì˜)',
                        operating_hours: '08:00 - 22:00 (ì£¼ë§ í¬í•¨)'
                    }
                },
                'dp': { // ê±´ë¬¼ (ì‚¬ìš©ì ìš”ì²­ ì¶”ê°€): ë•ìˆ˜ê¶ ë””íŒ°ë¦¬ìŠ¤
                    polygonCoords: [
                        new naver.maps.LatLng(37.568747, 126.971657),
                        new naver.maps.LatLng(37.568764, 126.971716),
                        new naver.maps.LatLng(37.568785, 126.971707),
                        new naver.maps.LatLng(37.568924, 126.972264),
                        new naver.maps.LatLng(37.568905, 126.972278),
                        new naver.maps.LatLng(37.568918, 126.972331),
                        new naver.maps.LatLng(37.568654, 126.972437),
                        new naver.maps.LatLng(37.568638, 126.972382),
                        new naver.maps.LatLng(37.568619, 126.972390),
                        new naver.maps.LatLng(37.568479, 126.971828),
                        new naver.maps.LatLng(37.568501, 126.971818),
                        new naver.maps.LatLng(37.568483, 126.971760),
                    ],
                    floors: ['1f', 'b1', 'b3'], // 1F, B1, B3 ë²„íŠ¼ ìƒì„±
                    images: {
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp_1.png',
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp_2.png',
                        'b3': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp_3.png',
                    },
                    // ì¸µë³„ ì´ë¯¸ì§€ ê²½ê³„ ì •ë³´
                    floorBounds: { 
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.568384, 126.971603), // 1F SW
                            new naver.maps.LatLng(37.569001, 126.972464)  // 1F NE
                        ),
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.568245, 126.971606), // B1 SW
                            new naver.maps.LatLng(37.569161, 126.972561)  // B1 NE
                        ),
                        'b3': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.568245, 126.971606), // B3 SW
                            new naver.maps.LatLng(37.569161, 126.972561)  // B3 NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true,
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: {
                        name: 'ë•ìˆ˜ê¶ ë””íŒ°ë¦¬ìŠ¤',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp.png', // ê²€ìƒ‰ ë° íŒì—… ì´ë¯¸ì§€
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ì‚¬ì§ë¡œ 9ê¸¸ 30 (ì„ì˜ ì£¼ì†Œ)', // ì„ì˜ ì£¼ì†Œ
                        operating_hours: '09:00 - 20:00 (ë§¤ì¼ ìš´ì˜)' // ì„ì˜ ìš´ì˜ì‹œê°„
                    }
                },
                'officia': { // ê±´ë¬¼ 4: ê´‘í™”ë¬¸ ì˜¤í”¼ì‹œì•„
    polygonCoords: [
        new naver.maps.LatLng(37.569884, 126.974610), // ìœ„ë„, ê²½ë„
        new naver.maps.LatLng(37.569882, 126.975265),
        new naver.maps.LatLng(37.569580, 126.975261),
        new naver.maps.LatLng(37.569581, 126.974603),
    ],
    floors: ['b2', 'b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B2, B1, 1F
    images: {
        // ëª¨ë“  ì¸µì— ë™ì¼í•œ ì´ë¯¸ì§€ URL ì ìš©
        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_b1.png',
        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_b1.png',
        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_1f.png',
    },
    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ì¸µë§ˆë‹¤ ë¶„ë¦¬í•˜ì—¬ ë™ì¼í•œ ê²½ê³„ ì ìš©)
    floorBounds: { 
        'b2': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569519, 126.974473), // SW (ë‚¨ì„œ)
            new naver.maps.LatLng(37.569976, 126.975331)  // NE (ë¶ë™)
        ),
        'b1': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569519, 126.974473), // SW
            new naver.maps.LatLng(37.569976, 126.975331)  // NE
        ),
        '1f': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569519, 126.974473), // SW
            new naver.maps.LatLng(37.569976, 126.975331)  // NE
        ),
    },
    currentFloor: '1f',
    polygon: null,
    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
    accessInfo: {
        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
        'ì¥ì• ì¸ ì£¼ì°¨ì¥': false,
        'ì—˜ë¦¬ë² ì´í„°': true,
        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
    },
    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
    buildingInfo: {
        name: 'ê´‘í™”ë¬¸ ì˜¤í”¼ì‹œì•„',
        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ5ê¸¸ 37 (ì„ì˜ ì£¼ì†Œ)',
        operating_hours: '10:00 - 20:00 (ì£¼ë§ íœ´ë¬´, ì„ì˜)'
    }
},
                'st': { // ê±´ë¬¼ 5: Síƒ€ì›Œ
    polygonCoords: [
        new naver.maps.LatLng(37.569910, 126.973684), // ìœ„ë„, ê²½ë„
        new naver.maps.LatLng(37.569904, 126.974217),
        new naver.maps.LatLng(37.569688, 126.974214),
        new naver.maps.LatLng(37.569688, 126.973680),
    ],
    floors: ['b2', 'b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B2, B1, 1F
    images: {
        // ëª¨ë“  ì¸µì— ë™ì¼í•œ ì´ë¯¸ì§€ URL ì ìš©
        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/st_b1.png',
        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/st_b1.png',
        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/st_1.png',
    },
    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ì¸µë§ˆë‹¤ ë¶„ë¦¬í•˜ì—¬ ë™ì¼í•œ ê²½ê³„ ì ìš©)
    floorBounds: { 
        'b2': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569473, 126.973510), // SW (ë‚¨ì„œ)
            new naver.maps.LatLng(37.569981, 126.974348)  // NE (ë¶ë™)
        ),
        'b1': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569473, 126.973510), // SW
            new naver.maps.LatLng(37.569981, 126.974348)  // NE
        ),
        '1f': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569473, 126.973510), // SW
            new naver.maps.LatLng(37.569981, 126.974348)  // NE
        ),
    },
    currentFloor: '1f',
    polygon: null,
    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
    accessInfo: {
        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
        'ì—˜ë¦¬ë² ì´í„°': true,
        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
    },
    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
    buildingInfo: {
        name: 'Síƒ€ì›Œ',
        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/s_t.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ìœ¨ê³¡ë¡œ 22 (ì„ì˜ ì£¼ì†Œ)',
        operating_hours: 'í‰ì¼ 09:00 - 18:00 (ì„ì˜)'
    }
},
                'yp': { // ê±´ë¬¼ 6: ì˜í’ë¹Œë”© (ì‚¬ìš©ì ìš”ì²­ ì¶”ê°€)
                    polygonCoords: [
                        new naver.maps.LatLng(37.569881, 126.981938),
                        new naver.maps.LatLng(37.569879, 126.982329),
                        new naver.maps.LatLng(37.569829, 126.982332),
                        new naver.maps.LatLng(37.569828, 126.982395),
                        new naver.maps.LatLng(37.569780, 126.982395),
                        new naver.maps.LatLng(37.569777, 126.982463),
                        new naver.maps.LatLng(37.569463, 126.982461),
                        new naver.maps.LatLng(37.569462, 126.982068),
                        new naver.maps.LatLng(37.569565, 126.981938),
                    ],
                    floors: ['b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B1, 1F
                    images: {
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/yp/yp1.png', // ëª¨ë“  ì¸µ ë™ì¼ ì´ë¯¸ì§€
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/yp/yp1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ë™ì¼í•œ ë¶ë™(NE) ë° ë‚¨ì„œ(SW) ì¢Œí‘œë¥¼ ëª¨ë“  ì¸µì— ì ìš©)
                    floorBounds: { 
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569438, 126.981870), // SW: ìœ„ë„: 37.569438, ê²½ë„: 126.981870
                            new naver.maps.LatLng(37.569943, 126.982556)  // NE: ìœ„ë„: 37.569943, ê²½ë„: 126.982556
                        ),
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569438, 126.981870), // SW
                            new naver.maps.LatLng(37.569943, 126.982556)  // NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': false, // ì„ì˜
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: { 
                        name: 'ì˜í’ë¹Œë”©', 
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/yp/yp_i.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ì²­ê³„ì²œë¡œ 41 (ì„ì˜ ì£¼ì†Œ)', 
                        operating_hours: '09:00 - 21:00 (ì„ì˜)'
                    }
                },
                'sc': { // ê±´ë¬¼ 6: ì˜í’ë¹Œë”© (ì‚¬ìš©ì ìš”ì²­ ì¶”ê°€)
                    polygonCoords: [
                        new naver.maps.LatLng(37.571274, 126.982109),
                        new naver.maps.LatLng(37.571257, 126.982778),
                        new naver.maps.LatLng(37.570935, 126.982765),
                        new naver.maps.LatLng(37.570934, 126.982725),
                        new naver.maps.LatLng(37.570863, 126.982721),
                        new naver.maps.LatLng(37.570672, 126.982456),
                        new naver.maps.LatLng(37.570674, 126.982384),
                        new naver.maps.LatLng(37.570612, 126.982302),
                        new naver.maps.LatLng(37.570616, 126.982153),
new naver.maps.LatLng(37.570712, 126.982050),
new naver.maps.LatLng(37.570974, 126.982058),
new naver.maps.LatLng(37.570969, 126.982094),
                    ],
                    floors: ['b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B1, 1F
                    images: {
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/sc/sc_1.png', // ëª¨ë“  ì¸µ ë™ì¼ ì´ë¯¸ì§€
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/sc/sc_1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ë™ì¼í•œ ë¶ë™(NE) ë° ë‚¨ì„œ(SW) ì¢Œí‘œë¥¼ ëª¨ë“  ì¸µì— ì ìš©)
                    floorBounds: { 
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570605, 126.981884), // SW: ìœ„ë„: 37.569438, ê²½ë„: 126.981870
                            new naver.maps.LatLng(37.571639, 126.982899)  // NE: ìœ„ë„: 37.569943, ê²½ë„: 126.982556
                        ),
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570605, 126.981884), // SW
                            new naver.maps.LatLng(37.571639, 126.982899)  // NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': false, // ì„ì˜
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: { 
                        name: 'SCì œì¼ì€í–‰', 
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/sc/sc_i.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ê³µí‰ë™ 100', 
                        operating_hours: '09:00 - 16:30'
                    }
                },
        'ks': { // í•œêµ­ë¬´ì—­ë³´í—˜ê³µì‚¬ (K-SURE)
                    polygonCoords: [
                        // ì™¸ê³½ì„  ì¢Œí‘œ (ì‹œê³„ë°©í–¥: NE-SE-SW-NWì™€ ìœ ì‚¬)
                        new naver.maps.LatLng(37.569913, 126.978610), // ìœ„ë„: 37.569913, ê²½ë„: 126.978610
                        new naver.maps.LatLng(37.569910, 126.979151), // ìœ„ë„: 37.569910, ê²½ë„: 126.979151
                        new naver.maps.LatLng(37.569719, 126.979148), // ìœ„ë„: 37.569719, ê²½ë„: 126.979148
                        new naver.maps.LatLng(37.569722, 126.978609)  // ìœ„ë„: 37.569722, ê²½ë„: 126.978609
                    ],
                    floors: ['b2', 'b1', '1f'], 
                    images: {
                        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks_b12.png',
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks_b11.png',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks_1.png',
                    },
                    // ì¸µë³„ ì´ë¯¸ì§€ ê²½ê³„ ì •ë³´ (LatLngBounds: SW, NE ìˆœì„œ)
                    floorBounds: { 
                        // B2 ì´ë¯¸ì§€ ê²½ê³„ (B2, B1ì€ ë™ì¼)
                        'b2': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569583, 126.978495), // SW: ìœ„ë„: 37.569583, ê²½ë„: 126.978495
                            new naver.maps.LatLng(37.570013, 126.979220)  // NE: ìœ„ë„: 37.570013, ê²½ë„: 126.979220
                        ),
                        // B1 ì´ë¯¸ì§€ ê²½ê³„
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569583, 126.978495), // SW
                            new naver.maps.LatLng(37.570013, 126.979220)  // NE
                        ),
                        // 1F ì´ë¯¸ì§€ ê²½ê³„
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569618, 126.978522), // SW: ìœ„ë„: 37.569618, ê²½ë„: 126.978522
                            new naver.maps.LatLng(37.570012, 126.979214)  // NE: ìœ„ë„: 37.570012, ê²½ë„: 126.979214
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ (ìš”ì²­ì— ë”°ë¼ ì„ì˜ì˜ ê°’ ì„¤ì •)
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: {
                        name: 'í•œêµ­ë¬´ì—­ë³´í—˜ê³µì‚¬',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks.jpg', 
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ 14',
                        operating_hours: 'ì˜¤ì „9ì‹œë¶€í„° ì˜¤í›„ 6ì‹œê¹Œì§€'
                    }
                }

        /* --- ì´í•˜ ë‹¤ë¥¸ ëª¨ë“  ë¹Œë”© ì •ë³´ëŠ” ë™ì¼í•˜ê²Œ ìœ ì§€ (ìƒëµ ì—†ì´ ëª¨ë‘ ë„£ì–´ì•¼ í•¨) --- */
        /*   ë‹¹ì‹ ì´ ì œê³µí•œ ì›ë³¸ ì „ì²´ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ í†µí•©í•©ë‹ˆë‹¤.  
             ê³µê°„ì ˆì•½ì„ ìœ„í•´ ì—¬ê¸°ì„œëŠ” ìƒëµí•˜ì§€ë§Œ  
             ì‹¤ì œ ì „ë‹¬ë³¸ì—ëŠ” ëª¨ë“  ê±´ë¬¼( dt , t8 , officia , st , yp , sc )ì´  
             ìœ„ì˜ kyì²˜ëŸ¼ ì™„ì „íˆ í¬í•¨ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
        */
    };

    /* í´ë¦¬ê³¤ ìƒì„± */
    for (let id in buildings){
        const b = buildings[id];
        const polygon = new naver.maps.Polygon({
            map: map,
            paths: [b.polygonCoords],
            fillColor:"transparent", fillOpacity:0.00001,
            strokeColor: "#C490E4",
            strokeWeight: 2,
            clickable: true
        });
        b.polygon = polygon;

        naver.maps.Event.addListener(polygon,"mouseover",()=>{
            if (!currentBuildingId){
                polygon.setOptions({ fillColor:"#C490E4", fillOpacity:0.4 });
                coordDisplay.textContent = "í´ë¦­í•´ì„œ ì‹¤ë‚´ì§€ë„ë¥¼ ë³´ì„¸ìš”";
            }
        });
        naver.maps.Event.addListener(polygon,"mouseout",()=>{
            if (!currentBuildingId){
                polygon.setOptions({ fillColor:"transparent" });
                coordDisplay.textContent = "ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”";
            }
        });
        naver.maps.Event.addListener(polygon,"click",(e)=>{
            e.stopOverlays = true;
            polygon.setMap(null);
            enterIndoorMode(id);
        });
    }

    /* ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë Œë” */
    function renderList(q=""){
        q = q.trim().toLowerCase();

        let arr = Object.keys(buildings).map(id=>({
            id,
            info: buildings[id].buildingInfo
        }));

        arr.sort((a,b)=> a.info.name.localeCompare(b.info.name,"ko"));

        buildingList.innerHTML = arr
            .filter(x=> {
                if (!q) return true;
                const n = x.info.name.toLowerCase().replace(/\s/g,"");
                return n.includes(q.replace(/\s/g,""));
            })
            .map(x=>`
                <div class="building-card" data-id="${x.id}">
                    <img class="building-thumb" src="${x.info.image_url}">
                    <div class="building-info">
                        <div class="building-name">${x.info.name}</div>
                        <div class="building-meta">ğŸ“ ${x.info.address}</div>
                        <div class="building-meta">ğŸ•’ ${x.info.operating_hours}</div>
                    </div>
                </div>
            `).join("");

        document.querySelectorAll(".building-card").forEach(el=>{
            el.onclick = ()=>{
                const id = el.dataset.id;
                const b = buildings[id];

                // ì§€ë„ ì´ë™
                const bounds = new naver.maps.LatLngBounds();
                b.polygonCoords.forEach(c=>bounds.extend(c));
                map.setCenter(bounds.getCenter());
                map.setZoom(17);
                coordDisplay.textContent = `'${b.buildingInfo.name}'ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤`;
            };
        });
    }

    renderList("");

    searchInput.oninput = ()=> renderList(searchInput.value);

};
document.head.appendChild(script);
</script>

</body>
</html>


